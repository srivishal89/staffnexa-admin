<!-- KEEP YOUR FULL UI SAME ABOVE -->

<script>
const API_BASE = "https://staffnexa-backend.onrender.com";

let candidates = [];
let selectedIds = new Set();

function getToken() {
    const token = localStorage.getItem("adminAuth");
    if (!token) {
        window.location.href = "index.html";
        return null;
    }
    return token;
}

async function fetchCandidates() {
    const token = getToken();
    if (!token) return;

    try {
        const res = await fetch(`${API_BASE}/candidates`, {
            headers: {
                "Authorization": "Basic " + token
            }
        });

        if (!res.ok) {
            localStorage.removeItem("adminAuth");
            window.location.href = "index.html";
            return;
        }

        const data = await res.json();

        candidates = data.map(c => ({
            id: c._id,
            name: c.name || "",
            phone: c.phone || "",
            role: c.jobRole || "",
            location: c.location || "",
            date: new Date(c.createdAt).toLocaleString()
        }));

        renderTable();

    } catch (err) {
        alert("Error loading data");
    }
}

function renderTable() {
    const tableBody = document.getElementById("tableBody");
    tableBody.innerHTML = "";

    candidates.forEach(c => {
        tableBody.innerHTML += `
            <tr>
                <td class="p-5">${c.name}</td>
                <td class="p-5">${c.phone}</td>
                <td class="p-5">${c.role}</td>
                <td class="p-5">${c.location}</td>
                <td class="p-5">${c.date}</td>
            </tr>
        `;
    });

    document.getElementById("total-count").innerText = candidates.length;
}

fetchCandidates();
</script>
